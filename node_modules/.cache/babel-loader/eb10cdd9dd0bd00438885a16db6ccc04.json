{"remainingRequest":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\jsonDrawer\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\jsonDrawer\\index.vue","mtime":1692714556029},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\babel.config.js","mtime":1692714559294},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1692715147026},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\babel-loader\\lib\\index.js","mtime":1692715146967},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1692715147026},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1692715135847}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVhY3RpdmUsIHRvUmVmcywgb25Nb3VudGVkLCBuZXh0VGljaywgZ2V0Q3VycmVudEluc3RhbmNlIH0gZnJvbSAndnVlJzsKaW1wb3J0IENsaXBib2FyZEpTIGZyb20gJ2NsaXBib2FyZCc7CmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJ2ZpbGUtc2F2ZXInOwppbXBvcnQgZXhwb3J0TW9kYWwgZnJvbSAnLi9leHBvcnRNb2RhbCc7CmV4cG9ydCBkZWZhdWx0IHsKICBlbWl0czogWyd1cGRhdGVDb25mJ10sCiAgY29tcG9uZW50czogewogICAgZXhwb3J0TW9kYWwKICB9LAogIHNldHVwKHByb3BzLCBjdHgpIHsKICAgIGxldCBlZGl0b3I7CiAgICBjb25zdCB7CiAgICAgIHByb3h5CiAgICB9ID0gZ2V0Q3VycmVudEluc3RhbmNlKCk7CiAgICBjb25zdCBkYXRhID0gcmVhY3RpdmUoewogICAgICBqc29uRHJhd2VyVmlzaWJsZTogZmFsc2UsCiAgICAgIGxvYWRpbmc6IHRydWUKICAgIH0pOwogICAgb25Nb3VudGVkKCgpID0+IHsKICAgICAgY29uc3QgY2xpcGJvYXJkID0gbmV3IENsaXBib2FyZEpTKCcuY29weS1qc29uLWJ0bicsIHsKICAgICAgICB0ZXh0OiB0cmlnZ2VyID0+IHsKICAgICAgICAgIGxldCBlZGl0b3IgPSBnZXRFZGl0b3IoKTsKICAgICAgICAgIHByb3h5LiRub3RpZmljYXRpb24uc3VjY2Vzcyh7CiAgICAgICAgICAgIG1lc3NhZ2U6IHByb3h5LiR0KCdiYXNlLnN1Y2Nlc3NmdWxseScpLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogcHJveHkuJHQoJ2Jhc2UuY29kZS5jb3B5LnN1Y2Nlc3NmdWxseScpCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBlZGl0b3IuZ2V0VmFsdWUoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBjbGlwYm9hcmQub24oJ2Vycm9yJywgZSA9PiB7CiAgICAgICAgcHJveHkuJG1lc3NhZ2UuZXJyb3IocHJveHkuJHQoJ2Jhc2UuY29kZS5jb3B5LmZhaWxlZCcpKTsKICAgICAgfSk7CiAgICB9KTsKICAgIGNvbnN0IGdldEVkaXRvciA9ICgpID0+IHsKICAgICAgaWYgKGVkaXRvcikgewogICAgICAgIHJldHVybiBlZGl0b3I7CiAgICAgIH0KICAgICAgZWRpdG9yID0gd2luZG93Lm1vbmFjby5lZGl0b3IuY3JlYXRlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0b3JKc29uJyksIHsKICAgICAgICB0aGVtZTogJ3ZzLWRhcmsnLAogICAgICAgIGxhbmd1YWdlOiAnanNvbicsCiAgICAgICAgYXV0b21hdGljTGF5b3V0OiB0cnVlCiAgICAgIH0pOwogICAgICByZXR1cm4gZWRpdG9yOwogICAgfTsKICAgIGNvbnN0IHNldEVkaXRvclZhbHVlID0gY29kZVN0ciA9PiB7CiAgICAgIGxldCBidGZDb2RlID0gYmVhdXRpZmllci5qcyhjb2RlU3RyKTsKICAgICAgbGV0IGVkaXRvciA9IGdldEVkaXRvcigpOwogICAgICBlZGl0b3Iuc2V0VmFsdWUoYnRmQ29kZSk7CiAgICB9OwogICAgY29uc3Qgb25DbG9zZSA9ICgpID0+IHsKICAgICAgZGF0YS5qc29uRHJhd2VyVmlzaWJsZSA9IGZhbHNlOwogICAgfTsKICAgIGNvbnN0IG9wZW4gPSAoY29uZmlnLCBmcm9tUnVsZSkgPT4gewogICAgICBkYXRhLmpzb25EcmF3ZXJWaXNpYmxlID0gdHJ1ZTsKICAgICAgbmV4dFRpY2soKCkgPT4gewogICAgICAgIHNldEVkaXRvclZhbHVlKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgIGZpZWxkczogY29uZmlnLAogICAgICAgICAgLi4uZnJvbVJ1bGUKICAgICAgICB9KSk7CiAgICAgICAgZGF0YS5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHJlZnJlc2ggPSAoKSA9PiB7CiAgICAgIGxldCBlZGl0b3IgPSBnZXRFZGl0b3IoKTsKICAgICAgbGV0IHsKICAgICAgICBmaWVsZHMsCiAgICAgICAgLi4ub3RoZXIKICAgICAgfSA9IEpTT04ucGFyc2UoZWRpdG9yLmdldFZhbHVlKCkpOwogICAgICBjdHguZW1pdCgndXBkYXRlQ29uZicsIHsKICAgICAgICBmaWVsZHMsCiAgICAgICAgZm9ybVJ1bGU6IG90aGVyCiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IG9wZW5FeHBvcnRNb2RhbCA9ICgpID0+IHsKICAgICAgcHJveHkuJHJlZnMuZXhwb3J0TW9kYWwub25PcGVuKCk7CiAgICB9OwogICAgY29uc3QgZXhwb3J0SnNvbkZpbGUgPSBmaWxlTmFtZSA9PiB7CiAgICAgIGlmICghZmlsZU5hbWUpIGZpbGVOYW1lID0gYCR7K25ldyBEYXRlKCl9Lmpzb25gOwogICAgICBjb25zdCBjb2RlU3RyID0gZ2V0RWRpdG9yKCkuZ2V0VmFsdWUoKTsKICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb2RlU3RyXSwgewogICAgICAgIHR5cGU6ICd0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgnCiAgICAgIH0pOwogICAgICBzYXZlQXMoYmxvYiwgZmlsZU5hbWUpOwogICAgfTsKICAgIGNvbnN0IGV4cG9ydE1vZGFsQ29uZm9ybSA9IGZpbGVOYW1lID0+IHsKICAgICAgZXhwb3J0SnNvbkZpbGUoZmlsZU5hbWUpOwogICAgfTsKICAgIHJldHVybiB7CiAgICAgIG9wZW4sCiAgICAgIHJlZnJlc2gsCiAgICAgIG9uQ2xvc2UsCiAgICAgIGV4cG9ydE1vZGFsQ29uZm9ybSwKICAgICAgb3BlbkV4cG9ydE1vZGFsLAogICAgICAuLi50b1JlZnMoZGF0YSkKICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["reactive","toRefs","onMounted","nextTick","getCurrentInstance","ClipboardJS","saveAs","exportModal","emits","components","setup","props","ctx","editor","proxy","data","jsonDrawerVisible","loading","clipboard","text","trigger","getEditor","$notification","success","message","$t","description","getValue","on","e","$message","error","window","monaco","create","document","getElementById","theme","language","automaticLayout","setEditorValue","codeStr","btfCode","beautifier","js","setValue","onClose","open","config","fromRule","JSON","stringify","fields","refresh","other","parse","emit","formRule","openExportModal","$refs","onOpen","exportJsonFile","fileName","Date","blob","Blob","type","exportModalConform"],"sources":["C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\jsonDrawer\\index.vue"],"sourcesContent":["<template>\n    <a-drawer\n        :visible=\"jsonDrawerVisible\"\n        width=\"45%\"\n        :body-style=\"{ padding: '0px' }\"\n        :closable=\"false\"\n    >\n        <a-spin tip=\"Loading...\" :spinning=\"loading\">\n            <div id=\"editorJson\" class=\"json-editor\"></div>\n            <div\n            :style=\"{\n                position: 'absolute',\n                bottom: 0,\n                width: '100%',\n                borderTop: '1px solid #e8e8e8',\n                padding: '5px 10px',\n                textAlign: 'right',\n                left: 0,\n                background: '#fff',\n                borderRadius: '0 0 4px 4px',\n            }\"\n            >\n                <a-button type=\"dashed\" style=\"marginRight: 8px\" @click=\"refresh\">\n                    <template #icon>\n                        <Icon name=\"reload\" />\n                    </template>\n                    {{ $t('base.refresh') }}\n                </a-button>\n                <a-button type=\"primary\" class=\"copy-json-btn\" style=\"marginRight: 8px\">\n                    <template #icon>\n                        <Icon name=\"copy\" />\n                    </template>\n                    {{ $t('base.copy.json.code') }}\n                </a-button>\n                <a-button\n                    type=\"primary\"\n                    style=\"marginRight: 8px\"\n                    @click=\"openExportModal\"\n                >\n                    <template #icon>\n                        <Icon name=\"cloud-download\" />\n                    </template>\n                    {{ $t('base.export.json.file') }}\n                </a-button>\n                <a-button @click=\"onClose\">\n                    <template #icon>\n                        <Icon name=\"close\" />\n                    </template>\n                    {{ $t('base.close') }}\n                </a-button>\n            </div>\n        </a-spin>\n    </a-drawer>\n    <export-modal ref=\"exportModal\" @confirm=\"exportModalConform\" />\n</template>\n<script>\nimport { reactive, toRefs, onMounted, nextTick, getCurrentInstance } from 'vue'\nimport ClipboardJS from 'clipboard'\nimport { saveAs } from 'file-saver'\nimport exportModal from './exportModal'\nexport default {\n    emits: ['updateConf'],\n    components: {\n        exportModal\n    },\n    setup(props, ctx){\n        let editor\n        const { proxy } = getCurrentInstance()\n        const data = reactive({\n            jsonDrawerVisible: false,\n            loading: true\n        })\n\n        onMounted(() => {\n            const clipboard = new ClipboardJS('.copy-json-btn', {\n                text: trigger => {\n                    let editor = getEditor()\n                    proxy.$notification.success({\n                        message: proxy.$t('base.successfully'),\n                        description: proxy.$t('base.code.copy.successfully')\n                    })\n                    return editor.getValue()\n                }\n            })\n            clipboard.on('error', e => {\n                proxy.$message.error(proxy.$t('base.code.copy.failed'))\n            })\n        })\n\n        const getEditor = () => {\n            if(editor){\n                return editor\n            }\n            editor = window.monaco.editor.create(\n                document.getElementById('editorJson'),{\n                    theme: 'vs-dark',\n                    language: 'json',\n                    automaticLayout: true\n                }\n            )\n            return editor\n        }\n\n        const setEditorValue = (codeStr) => {\n            let btfCode = beautifier.js(codeStr)\n            let editor = getEditor()\n            editor.setValue(btfCode)\n        }\n\n        const onClose = () => {\n            data.jsonDrawerVisible = false\n        }\n\n        const open = (config, fromRule) => {\n            data.jsonDrawerVisible = true\n            nextTick(() => {\n                setEditorValue(JSON.stringify({fields:config, ...fromRule}))\n                data.loading = false\n            })\n        }\n\n        const refresh = () => {\n            let editor = getEditor()\n            let { fields, ...other } = JSON.parse(editor.getValue())\n            ctx.emit('updateConf', { fields, formRule: other })\n        }\n\n        const openExportModal = () => {\n            proxy.$refs.exportModal.onOpen()\n        }\n\n        const exportJsonFile = (fileName) => {\n            if (!fileName) fileName = `${+new Date()}.json`\n            const codeStr = getEditor().getValue()\n            const blob = new Blob([codeStr], { type: 'text/plain;charset=utf-8' })\n            saveAs(blob, fileName)\n        }\n\n        const exportModalConform = (fileName) => {\n            exportJsonFile(fileName)\n        }\n\n        return {\n            open,\n            refresh,\n            onClose,\n            exportModalConform,\n            openExportModal,\n            ...toRefs(data)\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import '@/styles/mixin.scss';\n\n@include action-bar;\n\n.json-editor{\n  height: 100vh;\n}\n</style>"],"mappings":"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"}]}