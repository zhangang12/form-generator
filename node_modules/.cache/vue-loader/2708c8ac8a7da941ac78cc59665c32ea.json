{"remainingRequest":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\FormDrawer\\index.vue?vue&type=style&index=0&id=d86e3cba&lang=scss&scoped=true","dependencies":[{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\FormDrawer\\index.vue","mtime":1692714556618},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\css-loader\\dist\\cjs.js","mtime":1692715137249},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1692715135850},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\postcss-loader\\src\\index.js","mtime":1692715136255},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1692715151796},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1692715147026},{"path":"C:\\Users\\湛港\\Desktop\\form-generator\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1692715135847}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgJ0Avc3R5bGVzL21peGluLnNjc3MnOwoKLnRhYi1lZGl0b3IgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDQwcHg7CiAgYm90dG9tOiAwOwogIGxlZnQ6IDA7CiAgcmlnaHQ6IDA7CiAgZm9udC1zaXplOiAxNHB4Owp9Ci5sZWZ0LWVkaXRvciB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGhlaWdodDogMTAwJTsKICBiYWNrZ3JvdW5kOiAjMWUxZTFlOwogIG92ZXJmbG93OiBoaWRkZW47Cn0KLnNldHRpbmd7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHJpZ2h0OiAxNXB4OwogIHRvcDogM3B4OwogIGNvbG9yOiAjYTlmMTIyOwogIGZvbnQtc2l6ZTogMThweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgei1pbmRleDogMTsKfQoucmlnaHQtcHJldmlldyB7CiAgaGVpZ2h0OiAxMDAlOwogIC5yZXN1bHQtd3JhcHBlciB7CiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA0MHB4KTsKICAgIHdpZHRoOiAxMDAlOwogICAgb3ZlcmZsb3c6IGF1dG87CiAgICBwYWRkaW5nOiAxMnB4OwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICB9Cn0KQGluY2x1ZGUgYWN0aW9uLWJhcjsK"},{"version":3,"sources":["C:\\Users\\湛港\\Desktop\\form-generator\\src\\component\\FormDrawer\\index.vue"],"names":[],"mappings":";AA0OA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;AAE7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACT,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACP,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAClB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;AACZ;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACxB;AACF;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/湛港/Desktop/form-generator/src/component/FormDrawer/index.vue","sourceRoot":"","sourcesContent":["<template>\n    <a-drawer\n        v-model:visible=\"visible\"\n        :closable=\"false\"\n        width=\"100%\"\n        :body-style=\"{ padding: '0px' }\"\n    >\n        <div style=\"height:100vh\">\n            <a-row style=\"height:100vh; overflow:auto\">\n                <a-col :md=\"24\" :lg=\"12\" class=\"left-editor\">\n                    <a-tabs v-model:activeKey=\"activeTab\" size=\"large\" type=\"card\" class=\"editor-tabs\">\n                        <a-tab-pane key=\"html\">\n                            <template #tab>\n                            <span>\n                                <Icon name=\"edit\" v-if=\"activeTab=='html'\" style=\"color:#f1fa8c\" />\n                                <Icon name=\"code\" v-else style=\"color:#a95812\" />\n                                template\n                            </span>\n                            </template>\n                        </a-tab-pane>\n                        <a-tab-pane key=\"js\">\n                            <template #tab>\n                            <span>\n                                <Icon name=\"edit\" v-if=\"activeTab=='js'\" style=\"color:#f1fa8c\" />\n                                <Icon name=\"code\" v-else style=\"color:#a95812\" />\n                                script\n                            </span>\n                            </template>\n                        </a-tab-pane>\n                        <a-tab-pane key=\"css\">\n                            <template #tab>\n                            <span>\n                                <Icon name=\"edit\" v-if=\"activeTab=='css'\" style=\"color:#f1fa8c\" />\n                                <Icon name=\"code\" v-else style=\"color:#a95812\" />\n                                css\n                            </span>\n                            </template>\n                        </a-tab-pane>\n                    </a-tabs>\n                    <div v-show=\"activeTab==='html'\" id=\"editorHtml\" class=\"tab-editor\" />\n                    <div v-show=\"activeTab==='js'\" id=\"editorJs\" class=\"tab-editor\" />\n                    <div v-show=\"activeTab==='css'\" id=\"editorCss\" class=\"tab-editor\" />\n                </a-col>\n                <a-col :md=\"24\" :lg=\"12\" class=\"right-preview\">\n                    <div class=\"action-bar\" :style=\"{'text-align': 'left'}\">\n                        <a-button type=\"link\" size=\"small\" @click=\"runCode\">\n                            <Icon name=\"reload\" />\n                            {{ $t('base.refresh') }}\n                        </a-button>\n                        <a-divider type=\"vertical\" />\n                        <a-button type=\"link\" size=\"small\" @click=\"showExportModal\">\n                            <Icon name=\"cloud-download\" />\n                            {{ $t('base.export.vue.file') }}\n                        </a-button>\n                        <a-divider type=\"vertical\" />\n                        <a-button id=\"innerCopy\" class=\"copy-btn\" size=\"small\" type=\"link\">\n                            <Icon name=\"copy\" />\n                            {{ $t('base.copy.code') }}\n                        </a-button>\n                        <a-divider type=\"vertical\" />\n                        <a-button size=\"small\" type=\"link\" @click=\"onClose\">\n                            <Icon name=\"close-circle\" />\n                            {{ $t('base.close') }}\n                        </a-button>\n                    </div>\n                    <iframe\n                        v-show=\"isIframeLoaded\"\n                        ref=\"previewPage\"\n                        class=\"result-wrapper\"\n                        frameborder=\"0\"\n                        :src=\"iframeSrc\"\n                        @load=\"iframeLoad\"\n                    />\n                </a-col>\n            </a-row>\n        </div>\n    </a-drawer>\n    <export-modal ref=\"exportModal\" @confirm=\"exportModalConfirm\" />\n</template>\n<script>\nimport { exportDefault, beautifierConf, titleCase } from '@/utils/index'\nimport { reactive, toRefs, getCurrentInstance, nextTick, onMounted } from 'vue'\nimport MakeUp from './makeUp'\nimport exportModal from '../jsonDrawer/exportModal'\nimport ClipboardJS from 'clipboard'\nimport { saveAs } from 'file-saver'\nexport default {\n    components: {\n        exportModal\n    },\n    setup(props, ctx){\n\n        const { proxy } = getCurrentInstance()\n\n        let editorObj = {\n            html: null,\n            js: null,\n            css: null\n        }\n\n        const data = reactive({\n            isIframeLoaded: false,\n            visible: false,\n            activeTab: 'html',\n            iframeSrc: '/antdv/preview.html'\n            // iframeSrc: '/preview.html'\n        })\n\n        const onClose = () => {\n            data.visible = false\n        }\n\n        const getEditor = (type) => {\n            if(editorObj[type]){\n                return editorObj[type]\n            }\n            let id\n            let mode\n            switch (type) {\n                case 'html':\n                    id = 'editorHtml'\n                    mode = 'html'\n                    break;\n                case 'js':\n                    id = 'editorJs'\n                    mode = 'javascript'\n                    break\n                default:\n                    id = 'editorCss'\n                    mode = 'css'\n                    break;\n            }\n            editorObj[type] = monaco.editor.create(document.getElementById(id), {\n                theme: 'vs-dark',\n                language: mode,\n                automaticLayout: true\n            })\n            return editorObj[type]\n        }\n\n        const setEditorValue = (type, codeStr) => {\n            let editor = getEditor(type)\n            editor.setValue(codeStr)\n        }\n\n        const generateCode = (formData, codeTypeData, copy) => {\n            let makeUp = MakeUp(formData, codeTypeData, proxy)\n            if(copy){\n                makeUp.html = `<template>${makeUp.html}</template>`\n                // makeUp.js = `<script>${makeUp.js}<\\/script>`\n                // makeUp.css = `<style>\\n${makeUp.css}</style>`\n            }\n            return {\n                btfHtmlCode: beautifier.html(makeUp.html, beautifierConf.html),\n                btfJsCode: beautifier.js(makeUp.js, beautifierConf.js),\n                bftCssCode: beautifier.css(makeUp.css, beautifierConf.html)\n            }\n        }\n\n        const onOpen = (formData, codeTypeData) => {\n            data.visible = true\n            let { btfHtmlCode, btfJsCode, bftCssCode } = generateCode(formData, codeTypeData)\n            nextTick(() => {\n                setEditorValue('html', btfHtmlCode)\n                setEditorValue('js', btfJsCode)\n                setEditorValue('css', bftCssCode)\n                if(data.isIframeLoaded){\n                    runCode()\n                }\n            })\n        }\n\n        const showExportModal = () => {\n            proxy.$refs.exportModal.onOpen('vue')\n        }\n\n        const exportCode = () => {\n            let html = editorObj.html.getValue()\n            let js = editorObj.js.getValue()\n            let css = editorObj.css.getValue()\n            let htmlCode = beautifier.html(`<template>${html}</template>`)\n            return `${htmlCode}\\n<script setup>\\n${js}<\\/script>\\n<style>\\n${css}<style>`\n        }\n\n        const exportModalConfirm = (fileName) => {\n            if (!fileName) fileName = `${+new Date()}.vue`\n            let code = exportCode()\n            let blob = new Blob([code], { type: 'text/plain;charset=utf-8' })\n            saveAs(blob, fileName)\n        }\n\n        const iframeLoad = () => {\n            data.isIframeLoaded = true\n            runCode()\n        }\n\n        const runCode = () => {\n            let html = editorObj.html.getValue()\n            let js = editorObj.js.getValue()\n            let css = editorObj.css.getValue()\n            proxy.$refs.previewPage.contentWindow.postMessage({html,js,css})\n\n        }\n\n        onMounted(() => {\n            const clipboard = new ClipboardJS('#innerCopy', {\n                text: trigger => {\n                    let code = exportCode()\n                    proxy.$notification.success({\n                        message: proxy.$t('base.successfully'),\n                        description: proxy.$t('base.code.copy.successfully')\n                    })\n                    return code\n                }\n            })\n            clipboard.on('error', e => {\n                proxy.$message.error(proxy.$t('base.code.copy.failed'))\n            })\n        })\n\n        return {\n            onClose,\n            onOpen,\n            iframeLoad,\n            runCode,\n            generateCode,\n            showExportModal,\n            exportModalConfirm,\n            ...toRefs(data)\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import '@/styles/mixin.scss';\n\n.tab-editor {\n  position: absolute;\n  top: 40px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  font-size: 14px;\n}\n.left-editor {\n  position: relative;\n  height: 100%;\n  background: #1e1e1e;\n  overflow: hidden;\n}\n.setting{\n  position: absolute;\n  right: 15px;\n  top: 3px;\n  color: #a9f122;\n  font-size: 18px;\n  cursor: pointer;\n  z-index: 1;\n}\n.right-preview {\n  height: 100%;\n  .result-wrapper {\n    height: calc(100vh - 40px);\n    width: 100%;\n    overflow: auto;\n    padding: 12px;\n    box-sizing: border-box;\n  }\n}\n@include action-bar;\n</style>"]}]}